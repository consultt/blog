<!DOCTYPE html>

<html>

  <head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    Pushing to GitHub repo from Travis CI [WIP] - Aman&#39;s Blog
    
  </title>

  <meta name="description" content="">

  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="/blog/assets/vendor/bootstrap/css/bootstrap.min.css">

  <link rel="stylesheet" href="/blog/assets/vendor/fontawesome-free/css/all.min.css">

  <link rel="stylesheet" href="/blog/assets/main.css">
  <link rel="stylesheet" href="/blog/assets/scss/additional.css">
  <link rel="canonical" href="http://localhost:4000/blog/tech/2019/04/10/pushing-to-github-from-travis.html">
  <link rel="alternate" type="application/rss+xml" title="Aman&#39;s Blog" href="/blog/feed.xml">
  <link rel="shortcut icon" href="http://localhost:4000/blog/img/icons/favicon.ico">
  <link href="http://localhost:4000/blog/assets/scss/prism.css" rel="stylesheet" />
</head>


  <body>
    
    <link rel='shortcut icon' type='image/x-icon' href='/img/icons/favicon.ico' />

    <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a href="/blog/" class="logo">
      
      <img src="/blog/img/logo.png" alt="Aman's Blog">
      
    </a>
    <a class="navbar-brand" href="/blog/">Aman&#39;s Blog</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="http://localhost:4000">Homepage</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/">Blog Home</a>
        </li>
        <li class="nav-item dropdown" style="text-decoration: none;">
            <a href="/blog/posts">Posts &#9660;</a>
          <div class="dropdown-content">
              
                <a href="/blog/poetry">
                    Poetry
                </a>
              
                <a href="/blog/travel">
                    Travel
                </a>
              
                <a href="/blog/tech">
                    Tech
                </a>
              
                <a href="/blog/lifestyle">
                    Lifestyle
                </a>
              
                <a href="/blog/literature">
                    Literature
                </a>
              
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/contact">Contact</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog/search">Search</a>
        </li>
      </ul>
    </div>
  </div>
</nav>


    <!-- Page Header -->

<header class="masthead" style="background-image: url('/blog/img/pushing-to-github-from-Travis-CI/02-backdrop.jpg')">
  
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Pushing to GitHub repo from Travis CI [WIP]</h1>
            
            <h2 class="subheading">A guide to pushing changes to a GitHub repo from TravisCI</h2>
            
            <span class="meta">Posted by
              <a href="#">Aman Abhishek Tiwari</a>
              on April 10, 2019 &middot; <span class="reading-time" title="Estimated read time">
  
   3 mins  read </span>
</span>
             <span class="meta">
              Categories:
              
                  <a href="/blog/tech">
                      Tech
                  </a>
              
             </span>
            
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">

        <script src="http://localhost:4000/blog/assets/js/prism.js"></script>

<p>
Sometimes we may need to make some changes in a repository and push
it to the GitHub repository from TravisCI. An example would be to use TravisCI
to deploy a Jekyll website to github for which we can
build the website in TravisCI and push the <code> &#95;site </code>
data in the GitHub branch.

<br />

The issue comes when we try to push the changes in the git repository,
which requires authorisation, which can't be entered manually in TravisCI.

<br />

We can solve this issue with something called GitHub's
<code>Personal Access Tokens</code>. Generate a <code>Pesonal Access Token</code>
by following
<a target="_blank" rel="noopener noreferrer" href="https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line">this article</a>
by GitHub.

<br />

While generating the token, we need to give access to the github repository.
For this, check the options shown in the image below (in black border) on the
Token generator page. This will allow the service with this token to make
changes to a repository in GitHub.

<br />

<img src="/blog/img/pushing-to-github-from-Travis-CI/01-github-token-generator.jpg" alt="GitHub Token Generator" style="max-width:100%;" />

<br />
<br />


Now we need to tell TravisCI about the token. But this GitHub token
has to be encrypted before we give it to TravisCI. To do this first
install <code>travis</code> in your local linux machine and login to
<code>travis</code> by using these commands:
<pre>
  <code class="language-bash">
      sudo gem install travis
      travis login
  </code>
</pre>

After this, add these lines in the <code>after_script</code> part of your
<code>.travis.yml</code> file.

<pre>
  <code class="language-yaml">
 after_script:
   - git config credential.helper "store --file=.git/credentials"
   - echo "https://${GH_TOKEN}:@github.com" &gt; .git/credentials
   - node ./node_modules/grunt-cli/bin/grunt release
  </code>
</pre>

Now, while staying in the directory where <code>.travis.yml</code> is,
run,

<pre>
  <code class="language-bash">
    travis encrypt 'GITHUB_TOKEN=&lt;REPLACE-WITH-YOUR-GITHUB-PERSONAL-ACCESS-TOKEN&gt;' --add
  </code>
</pre>

This will add the encrypted <code>Personal Access Token</code> in
your <code>.travis.yml</code> file.

<br />

When TravisCI builds on your repo, it stores this token in the global
variable <code class="language-bash">GITHUB_TOKEN</code>, which you can
use to push to a particular github repository via a command which looks
something like this

<pre>
  <code class="language-bash">
    git push -f -q https://${GITHUB_TOKEN}@github.com/&lt;GITHUB-USERNAME&GT;/&lt;GITHUB-REPO-NAME&gt;.git &lt;DEPLOY_BRANCH&gt;
  </code>
</pre>

Note however that the command <code class="language-bash">git push</code>
can only be used after the variable <code class="language-bash">GITHUB_TOKEN</code>
has been initialised, which only happens after the commands shown in
<code>after_script</code> section of the <code>.travis.yml</code> has
been executed. So, any script using <code class="language-bash">git push</code>
should be put after those three commands in <code>after_script</code>.
</p>

<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document, s = d.createElement('script');

        s.src = 'https://amanabt.disqus.com/embed.js';  // IMPORTANT: Replace EXAMPLE with your forum shortname!

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



        <hr>

        <div class="clearfix">

          
          <a class="btn btn-primary float-left" href="/blog/travel/2019/03/23/nainital-trekking-guide.html"
            data-toggle="tooltip" data-placement="top" title="Nainital Trekking Guide">&larr; Previous<span class="d-none d-md-inline">
              Post</span></a>
          
          
          <a class="btn btn-primary float-right" href="/blog/lifestyle/2021/08/30/being-simple-and-frugal-001.html"
            data-toggle="tooltip" data-placement="top" title="Being Simple and Frugal">Next<span class="d-none d-md-inline">
              Post</span> &rarr;</a>
          

        </div>

      </div>
    </div>
  </div>


    <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:aman.iitk072@gmail.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-mailchimp fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          
          <li class="list-inline-item">
            <a href="https://www.facebook.com/aman.iitk072">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-facebook-f fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.linkedin.com/in/aman2official">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://github.com/amanabt">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          <li class="list-inline-item">
            <a href="https://www.goodreads.com/user/show/81434158-aman">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-goodreads fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; Aman Abhishek Tiwari 2022</p>
      </div>
    </div>
  </div>
</footer>


    <script src="/blog/assets/vendor/jquery/jquery.min.js"></script>
<script src="/blog/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/blog/assets/vendor/startbootstrap-clean-blog/js/clean-blog.min.js"></script>

<script src="/blog/assets/scripts.js"></script>




    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136869850-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-136869850-1');
</script>



  </body>

</html>
